# Xan zine: May 2024 Edition

Upgrade to the latest version (at least 0.12.0) using:

```bash
cargo install xan
```

## Summary

* [Progress command](#progress-command)
* [Renaming kway command as merge](#renaming-kway-command-as-merge)
* [Union-find command](#union-find-command)

## Progress command

Sometimes it would be nice to display a progress bar when working on a very large file, typically when performing costly operations line by line (e.g. when reading or writing files).

It is now possible thanks to the `progress` command that reads a CSV file line by line and forward them to `stdout` all while printing the desired progress bar.

![progress](../img/progress.gif)

The command is able to work at line or byte level, will prebuffer some of the file for you to attempt finding the total number of lines ahead of time etc.

What's more, the progress bar will be colored in green if the process exited successfuly, in yellow if it was interrupted by the user and in red if some error occurred.

```txt
Display a progress bar while reading the rows of a CSV file.

The command will try and buffer some of the ingested file to find
the total number of rows automatically. If you know the total
beforehand, you can also use the --total flag.

Usage:
    xan progress [options] [<input>]
    xan progress --help

progress options:
    -S, --smooth         Flush output buffer each time one row is written.
                         This makes the progress bar smoother, but might be
                         less performant.
    -B, --bytes          Display progress on file bytes, rather than parsing CSV lines.
    --prebuffer <n>      Number of megabytes of the file to prebuffer to attempt
                         knowing the progress bar total automatically.
                         [default: 64]
    --title <string>     Title of the loading bar.
    --total <n>          Total number of rows of given CSV file.

Common options:
    -h, --help             Display this message
    -n, --no-headers       When set, the first row will be included in
                           the progress bar total.
    -o, --output <file>    Write output to <file> instead of stdout.
    -d, --delimiter <arg>  The field delimiter for reading CSV data.
                           Must be a single character.
```

## Renaming kway command as merge

The `kway` (ðŸ§¥) term was tied to the underlying implementation of the command (relying on the [k-way merge algorithm](https://en.wikipedia.org/wiki/K-way_merge_algorithm)) which is obscure for most people. The command was therefore renamed as `xan merge` which a little bit clearer.

As a reminder, this command is able to "merge" multiple CSV files sharing the same column and order into a single ordered file (not a simple concatenation).

## Union-find command

An experimental `union-find` command was added to `xan`. It is based on the very famous [Union-Find](https://en.wikipedia.org/wiki/Disjoint-set_data_structure) algorithm and is able to label the connected components of a graph, represented here by a CSV file of edges with a column for sources and another one for targets.

It returns a CSV file of nodes and the attached labels. It is also able to return a CSV file of nodes contained within the largest components, or even a CSV file of connected component sizes. It runs in `O(E)` time and `O(N)` memory, `E` being the number of edges, i.e. the number of lines of the input file, and `N` being the number of nodes in the graph.

```txt
Apply the union-find algorithm on a CSV file representing a graph's
edge list (one column for source nodes, one column for target nodes) in
order to return a CSV of nodes with a component label.

The command can also return only the nodes belonging to the largest connected
component using the -L/--largest flag or the sizes of all the connected
components of the graph using the -S/--sizes flag.

Usage:
    xan union-find <source> <target> [options] [<input>]
    xan union-find --help

union-find options:
    -L, --largest  Only return nodes belonging to the largest component.
                   The output CSV file will only contain a 'node' column in
                   this case.
    -S, --sizes    Return a single CSV column containing the sizes of the graph's
                   various connected components.

Common options:
    -h, --help             Display this message
    -o, --output <file>    Write output to <file> instead of stdout.
    -n, --no-headers       When set, the first row will not be interpreted
                           as headers.
    -d, --delimiter <arg>  The field delimiter for reading CSV data.
                           Must be a single character.
```